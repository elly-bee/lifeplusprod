{% extends 'layouts/base-presentation.html' %}
{% load static %}

{% block content %}


<header class="header-2">
  <div class="page-header section-height-25 relative" style="background-image: url('{{ ASSETS_ROOT }}/img/curved-images/curved.jpg')">
    <div class="container">
      <div class="row">
        <div class="text-center">
          <h1 class="text-white">
            <a class="text-white" target="_blank" 
               href="#">Life | Plus</a>
          </h1>
        
         
        </div>
      </div>
    </div>
    <div class="position-absolute w-100 z-index-1 bottom-0">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 40" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="moving-waves">
          <use xlink:href="#gentle-wave" x="48" y="-1" fill="rgba(255,255,255,0.40" />
          <use xlink:href="#gentle-wave" x="48" y="3" fill="rgba(255,255,255,0.35)" />
          <use xlink:href="#gentle-wave" x="48" y="5" fill="rgba(255,255,255,0.25)" />
          <use xlink:href="#gentle-wave" x="48" y="8" fill="rgba(255,255,255,0.20)" />
          <use xlink:href="#gentle-wave" x="48" y="13" fill="rgba(255,255,255,0.15)" />
          <use xlink:href="#gentle-wave" x="48" y="16" fill="rgba(255,255,255,0.95" />
        </g>
      </svg>
    </div>
  </div>
</header>



<div class="container-fluid py-4">
  <div class="row">
    <!-- Personal and Contact Details Section -->
    <div class="col-lg-8">
      <div class="card bg-light shadow-sm rounded">
        <div class="card-body p-4">
          <!-- Personal Details Section -->
          <h6 class="text-primary mb-3">Personal Details</h6>
          <hr>
          <div class="row mb-4">
            <div class="col-md-4">
              <h6 class="mb-1">First Name</h6>
              <p class="mb-0">{{ user.first_name }}</p>
            </div>
            <div class="col-md-4">
              <h6 class="mb-1">Last Name</h6>
              <p class="mb-0">{{ user.last_name }}</p>
            </div>
            <div class="col-md-4">
              <h6 class="mb-1">Other Names</h6>
              <p class="mb-0">N/A</p>
            </div>
          </div>
          <div class="row mb-4">
            <div class="col-md-4">
              <h6 class="mb-1">Marital Status</h6>
              <p class="mb-0">{{ user.marital_status }}</p>
            </div>
            <div class="col-md-4">
              <h6 class="mb-1">Gender</h6>
              <p class="mb-0">{{ user.gender }}</p>
            </div>
            <div class="col-md-4">
              <h6 class="mb-1">Date of Birth</h6>
              <p class="mb-0">{{ user.dateofbirth }}</p>
            </div>
          </div>

          <!-- Contact Details Section -->
          <h6 class="text-primary mb-3">Contact Details</h6>
          <hr>
          <div class="row mb-4">
            <div class="col-md-4">
              <h6 class="mb-1">Address</h6>
              <p class="mb-0">{{ user.address }}</p>
            </div>
            <div class="col-md-4">
              <h6 class="mb-1">Primary Number</h6>
              <p class="mb-0">{{ user.phone_number_1 }}</p>
            </div>
            <div class="col-md-4">
              <h6 class="mb-1">Email Address</h6>
              <p class="mb-0">{{ user.email }}</p>
            </div>
          </div>

          <!-- Member Details Section -->
          <h6 class="text-primary mb-3">Member Details</h6>
          <hr>
          <div class="row mb-4">
            <div class="col-md-4">
              <h6 class="mb-1">Registered Under</h6>
              <p class="mb-0">{{ user.parent }}</p>
            </div>
            <div class="col-md-4">
              <h6 class="mb-1">Sponsor</h6>
              <p class="mb-0">{{ user.keyBonus }}</p>
            </div>
            <div class="col-md-4">
              <h6 class="mb-1">Member ID</h6>
              <p class="mb-0">{{ user.usercode }}</p>
            </div>
          </div>
          <div class="row mb-4">
            <div class="col-md-4">
              <h6 class="mb-1">Status</h6>
              <p class="mb-0">{{ user.my_status }}</p>
            </div>
            <div class="col-md-4">
              <h6 class="mb-1"></h6>
              <p class="mb-0"></p>
            </div>
            <div class="col-md-4">
              <h6 class="mb-1"></h6>
              <p class="mb-0"></p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Sidebar Section -->
    <div class="col-lg-4">
      <div class="card h-100">
        <div class="card-header pb-0 p-3 d-flex justify-content-between align-items-center">
          <h6 class="mb-0">Account Overview</h6>
          <button class="btn btn-outline-primary btn-sm mb-0" data-bs-toggle="modal" data-bs-target="#AddMember">Complete Registration</button>
        </div>
        <hr>
        <div class="card-body p-3 pb-0">
          <h6 class="mb-3">E Balance</h6>
          <ul class="list-unstyled mb-4">
            <li><strong>Account Name:</strong> {{ myAccount.0.acc_type_id__name }}</li>
            <li><strong>Balance:</strong> {{ myAccount.0.cur_bal }}</li>
          </ul>
          <hr>
          <form method="post" class="mb-4">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" name="search_button" class="btn btn-outline-primary btn-sm mb-0">Search</button>
          </form>
          {% if searched_user %}
            <hr>
            <h6 class="mb-3">Support Incentive (Keyin Bonus) Pay to</h6>
            <ul class="list-unstyled mb-4">
              <li><strong>First Name:</strong> {{ searched_user.first_name }}</li>
              <li><strong>Last Name:</strong> {{ searched_user.last_name }}</li>
              <li><strong>Username:</strong> {{ searched_user.username }}</li>
              <li><strong>Email:</strong> {{ searched_user.email }}</li>
            </ul>
            <form method="post">
              {% csrf_token %}
              <input type="hidden" name="keyBonus_username" value="{{ searched_user.username }}">
              <button type="submit" name="save_button" class="btn btn-outline-primary btn-sm mb-0">Select as Key Bonus</button>
            </form>
          {% endif %}

          <form method="post" class="mb-4">
            {% csrf_token %}
            {{ parentform.as_p }}
            <button type="submit" name="search_usercode" class="btn btn-outline-primary btn-sm mb-0">Search</button>
          </form>
          {% if parent_user %}
            <hr>
            <h6 class="mb-3">Support Incentive (Keyin Bonus) Pay to</h6>
            <ul class="list-unstyled mb-4">
              <li><strong>First Name:</strong> {{ parent_user.first_name }}</li>
              <li><strong>Last Name:</strong> {{ parent_user.last_name }}</li>
              <li><strong>Username:</strong> {{ parent_user.username }}</li>
              <li><strong>Email:</strong> {{ parent_user.email }}</li>
            </ul>
            <form method="post">
              {% csrf_token %}
              <input type="hidden" name="usercode_parent" value="{{ parent_user.username }}">
              <button type="submit" name="save_usercode" class="btn btn-outline-primary btn-sm mb-0">Select as Parent</button>
            </form>
          {% endif %}
         
        </div>
      </div>
    </div>
  </div>
</div>


        <!-- Modal -->
        <div class="modal fade" id="AddMember" tabindex="-1" aria-labelledby="AddMember" aria-hidden="true">
          <div class="modal-dialog modal-lg">
            <!-- Change modal-dialog to modal-lg or modal-xl -->
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="AddMember">Recruit A Member</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
            
              <form role="form" method="post" autocomplete="off"> {% csrf_token %} <div class="row">
                  <div class="col-lg-12 mb-lg-0 mb-6">
                    <div class="card mt-4 h-100">
                      <div class="card-body p-3 pb-0">
                        <ul class="list-group">
                          <div class="d-flex flex-column">
                            <h6 class="text-dark mb-1 font-weight-bold text-sm">Keyin bonus paid to</h6>
                            {% if searched_user %}
                              {{searched_user.first_name}} {{searched_user.last_name}}
                            {%else%}
                              {{user.first_name}} {{user.last_name}}
                            {%endif%}
                          </div>
                          <div class="d-flex flex-column">
                            <h6 class="text-dark mb-1 font-weight-bold text-sm">{{ myAccount.0.acc_type_id__name }} Account Balance</h6>
                            {{ myAccount.0.cur_bal }}
                          </div>
                          <div class="d-flex flex-column">
                            <h6 class="text-dark mb-1 font-weight-bold text-sm">Package</h6>
                            <div class="d-none">{{product_form.user}}</div>
                            {{product_form.package}}
                          </div>
                        </ul>
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer justify-content-between">
                    <button type="button" class="btn bg-gradient-dark" data-bs-dismiss="modal">Close</button>
                    <button type="submit" name="complete_recruit" class="btn bg-gradient-primary">Add Member</button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>


      <div class="modal fade" id="messageModal" tabindex="-1" role="dialog" aria-labelledby="messageModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="messageModalLabel">Notification</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" id="modalBody">
                    <!-- Message content will be injected here -->
                    {% if messages %}
                    <ul>
                        {% for message in messages %}
                            <li>{{ message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Include jQuery and Bootstrap JS if using Bootstrap for modals -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <script>
        // Function to show modal with a message
        function showModal(message, type) {
            var modalBody = document.getElementById('modalBody');
            modalBody.innerHTML = message;
            
            // Show the modal
            $('#messageModal').modal('show');
        }

        // Check if there are any messages to show
        document.addEventListener('DOMContentLoaded', function() {
            {% if messages %}
                {% for message in messages %}
                    var message = "{{ message.message }}";
                    var type = "{{ message.tags }}"; // 'success' or 'error'
                    showModal(message, type);
                {% endfor %}
            {% endif %}
        });
    </script>


{% endblock content %}